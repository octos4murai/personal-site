<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Coercion in JavaScript | Al Idian</title>

    <meta name="description" content="A personal site about software development">

    <link rel="preconnect" href="https://fonts.gstatic.com"> 
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@400;700&amp;family=Merriweather&amp;display=swap">

    <link rel="stylesheet" href="/css/syntax-highlight.css">
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <header>
        <h3 id="site-title" class="no-margin no-padding"><a href="/">Al Idian</a></h3>
    </header>

    <main>
        
<h1 id="post-title">Coercion in JavaScript</h1>
<p id="post-date" class="gray-text">2017.04.02</p>

<h3>Static vs Dynamic Typing</h3>
<p>The difference between static typing and dynamic typing has to do with two things:</p>
<ol>
<li>When the type checking is done, and</li>
<li>Whether variables can be assigned values of different types at run time.</li>
</ol>
<p>Statically-typed languages determine variable type at compile time, and the type remains unchanged throughout the entire program execution. On the other hand, dynamically-typed languages have variables that are not associated with any particular type. Therefore, the types of values assigned are determined “on-the-fly” and can change during program execution.</p>
<p>Often, statically-typed languages require the programmer to indicate a variable’s type, while dynamically-typed languages do not. However, this is not always the case!</p>
<pre class="language-csharp"><code class="language-csharp"><span class="token comment">// Often, statically-typed languages require the programmer to indicate a variable's type...</span><br><span class="token class-name"><span class="token keyword">string</span></span> a <span class="token operator">=</span> <span class="token string">"foo"</span><span class="token punctuation">;</span></code></pre>
<pre class="language-javascript"><code class="language-javascript"><span class="token comment">// ... while dynamically-typed languages do not.</span><br><span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token string">"foo"</span><span class="token punctuation">;</span></code></pre>
<h3>Coercion in Javascript</h3>
<p>As a dynamically-typed language, allows variables to be assigned values of different types:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="highlight-line"><span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token string">"foo"</span><span class="token punctuation">;</span>      <span class="token comment">// b is assigned the string value foo</span></span><br><span class="highlight-line">b <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span>             <span class="token comment">// b is reassigned the numeric value 15</span></span><br><mark class="highlight-line highlight-line-active"><span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token boolean">true</span> <span class="token operator">&amp;&amp;</span> b<span class="token punctuation">;</span>  <span class="token comment">// c is assigned the value 15</span></mark></code></pre>
<p>To support this, Javascript relies on coercion, which means implicitly converting a variable’s type to another. For the unaware, coercion can cause some seemingly strange behaviour. In the highlighted line of the snippet above for instance, variable c is assigned the numeric value <em>15</em> because the operator <em>&amp;&amp;</em> causes <em>b</em> to be evaluated to <em>true</em> (i.e. var <em>c</em> = <em>true</em> &amp;&amp; <em>true</em>) — but then assigns the real value (before coercion) of the last operand to c.</p>
<p>Because Javascript syntax is so close to that of Java (and C#, etc.), Javascript developers coming from these languages are sometimes deceived into thinking the equality operator <em>==</em> in Javascript is the same as that in Java. Because Javascript coerces values, <em>==</em> in Javascript is less stringent than in Java. For instance:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token comment">// Each of the following evaluates to true</span><br><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">==</span> <span class="token string">'1'</span><span class="token punctuation">;</span><br><span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token operator">==</span> <span class="token string">'false'</span><span class="token punctuation">;</span><br><span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token number">15</span> <span class="token operator">==</span> <span class="token string">'1'</span> <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">;</span></code></pre>
<p>In my opinion, <em>===</em> (or <em>strict equality</em>) should be used instead of <em>==</em> unless there is a specific reason to do otherwise. Unlike <em>==</em>, <em>===</em> takes coercion out of the equation (<em>punny!</em>):</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token comment">// Each of the following evaluates to false</span><br><span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">===</span> <span class="token string">'1'</span><span class="token punctuation">;</span><br><span class="token keyword">var</span> e <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token operator">===</span> <span class="token string">'false'</span><span class="token punctuation">;</span><br><span class="token keyword">var</span> f <span class="token operator">=</span> <span class="token number">15</span> <span class="token operator">===</span> <span class="token string">'1'</span> <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">;</span></code></pre>
<h3>Leveraging Coercion</h3>
<p>When used properly, coercion and <em>==</em> can allow developers to write some really clean and concise code. Note the example below:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">var</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">;</span><br><br><span class="token operator">...</span><br><br><span class="token comment">// Method A</span><br><span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">||</span> a <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Hello world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token comment">// Method B</span><br><span class="token keyword">if</span> <span class="token punctuation">(</span>b <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Hello world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token comment">// Method C</span><br>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c <span class="token operator">||</span> <span class="token string">"Hello world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Methods<sup>1</sup> A, B, C all do the same thing but are written in order of conciseness. All three methods check whether a variable (a, b, or c) is <em>null</em> or <em>undefined</em> <sup>2</sup>.</p>
<p>Method A is the clunkiest implementation. The strict equality is used to check that the variable is not strictly equal to null and not strictly equal to undefined.</p>
<p>Method B uses coercion and the <em>==</em> operator. Since the Javascript engine coerces b to be equal to <em>null</em> even if its value is actually <em>undefined</em>, we can use this singular check to achieve the desired result.</p>
<p>Method C is the most elegant solution and also demonstrates knowledge of coercion. If c is either <em>null</em> or <em>undefined</em>, the alternate value “Hello world” is printed in its stead.</p>
<h3>TL/DR</h3>
<p>Understanding coercion (along with <em>equality</em> and <em>strict equality</em> in Javascript) allows developers to avoid common pitfalls and write cleaner, more elegant code.</p>
<p class="center-text section-divider">
    -----
</p>
<h3>Notes</h3>
<ul>
<li><sup>1</sup> To be clear, the word <em>method</em> is not used in the object-oriented sense here.</li>
<li><sup>2</sup> In Javascript, <em>null</em> and <em>undefined</em> are two distinct primitive values. <em>null</em> connotes an intentional lack of value, while <em>undefined</em> means a value was never set.</li>
</ul>

    </main>

    <footer>
        <p class="center-text no-margin no-padding"><a href="https://github.com/octos4murai/personal-site/blob/master/LICENSE">MIT License</a></p>
        <p class="center-text no-margin no-padding"><a href="https://github.com/octos4murai/personal-site">/octos4murai</a></p>
    </footer>
</body>
</html>