<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Improvising Float Division in Tableau | Al Idian</title>

    <meta name="description" content="A personal site about software development">

    <link rel="preconnect" href="https://fonts.gstatic.com"> 
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@400;700&amp;family=Merriweather&amp;display=swap">

    <link rel="stylesheet" href="/css/syntax-highlight.css">
    <link rel="stylesheet" href="/css/style.css">

    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
    <link rel="manifest" href="/favicon/site.webmanifest">
</head>
<body>
    <header>
        <h3 id="site-title" class="no-margin no-padding"><a href="/">Al Idian</a></h3>
    </header>

    <main>
        
<h1 id="post-title">Improvising Float Division in Tableau</h1>
<p id="post-date" class="gray-text">2016.09.10</p>

<h3>The Problem</h3>
<p>Working with Tableau 9.3, I was surprised to find that a built-in function for dividing two floats was missing. I don’t know if this has been remedied in the most recent version of Tableau.</p>
<p>Tableau 9.3 has only one division function: DIV(integer, integer), which returns the integer portion of the quotient. Since my task was to divide two floats (each with three decimal places), my problem was two-part:</p>
<ol>
<li>Find a way to simulate float division using integer division, and</li>
<li>Get both the integer and non-integer portions of the quotient.</li>
</ol>
<h3>Test Variables</h3>
<blockquote>
<p>float <em>a</em> = 5.502</p>
</blockquote>
<blockquote>
<p>float <em>b</em> = 2.437</p>
</blockquote>
<p>The quotient of <em>a</em> and <em>b</em> to three decimal places is 2.258. This is the result we want to get.</p>
<h3>Solution</h3>
<p>The most direct approach to try is simply to cast <em>a</em> and <em>b</em> as integers. This will allow us to use Tableau’s built-in DIV function:</p>
<blockquote>
<p>DIV(INT(<em>a</em>), INT(<em>b</em>))</p>
</blockquote>
<blockquote>
<blockquote>
<p>= DIV(INT(5.502), INT(2.437))</p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>= DIV(6, 2)</p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>= <span class="red-text">3</span></p>
</blockquote>
</blockquote>
<p>This solution is problematic for a number of reasons, but the primary reason is that the conversion between integer to float causes enough information loss so as to change the result. Thus, the answer derived is quite far from the one we want to get.</p>
<p>The next approach to try is to use the MOD (short for <em>modulo</em>) and FLOOR operations. MOD gets the remainder portion in a division operation. This is useful when we don’t necessarily care about the non-integer portion of the quotient. FLOOR, on the other hand truncates a certain portion of a number starting from a particular position. In our example, we use FLOOR to truncate the fractional portion of our floats.</p>
<p>Applying these to the same example, we get:</p>
<blockquote>
<p>DIV(INT(FLOOR(<em>a</em>)), INT(FLOOR(<em>b</em>))) + MOD(<em>a</em>, <em>b</em>)</p>
</blockquote>
<blockquote>
<blockquote>
<p>= DIV(INT(FLOOR(5.502)), INT(FLOOR(2.437))) + MOD(5.502, 2.437)</p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>= DIV(5, 2) + MOD(5.502, 2.437)</p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>= 2 + 0.628</p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>= <span class="green-text">2</span>.<span class="red-text">628</span></p>
</blockquote>
</blockquote>
<p>The problem here seems to lie in the fractional part of the result — the portion computed using MOD. And indeed, the error is caused by the fact that MOD returns the remainder as a raw value rather than as a portion of the quotient. In our example, MOD returned 0.628 instead of the expected 0.258 (which can be derived by dividing 0.628 by <em>b</em>).</p>
<p>In this last attempt, we move away from MOD and FLOOR. Instead, we multiply the dividend by 10<sup>3</sup>, perform the division, and then multiply the result by 10<sup>-3</sup>. Note that we use the exponent 3 since our floats have precision 3 (three decimal places).</p>
<blockquote>
<p>DIV(INT(<em>a</em> x 10<sup>3</sup>), INT(<em>b</em>)) x 10<sup>-3</sup></p>
</blockquote>
<blockquote>
<blockquote>
<p>= DIV(INT(5.502 x 10<sup>3</sup>), INT(2.437)) x 10<sup>-3</sup></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>= DIV(INT(5502), INT(2437)) x 10<sup>-3</sup></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>= 2258 x 10<sup>-3</sup></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>= <span class="green-text">2.258</span></p>
</blockquote>
</blockquote>
<p>We were able to simulate float division using integer division, as well as return both the integer and non-integer portions of the quotient. This approach does the job!</p>
<h3>TL/DR</h3>
<p>Tableau 9.3 only allows integer division. To perform a division operation between two floats, multiply the dividend by 10<sup>x</sup> before dividing (where <em>x</em> is the precision of the floats). After performing the division, multiply the result by 10<sup>-x</sup>.</p>

    </main>

    <footer>
        <p class="center-text no-margin no-padding"><a href="https://github.com/octos4murai/personal-site/blob/master/LICENSE">MIT License</a></p>
        <p class="center-text no-margin no-padding"><a href="https://github.com/octos4murai/personal-site">/octos4murai</a></p>
    </footer>
</body>
</html>
